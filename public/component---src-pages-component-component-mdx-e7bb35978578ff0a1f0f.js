(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"7evJ":function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return c})),n.d(t,"default",(function(){return s}));n("rzGZ"),n("Dq+y"),n("8npG"),n("Ggvi"),n("E5k/"),n("q1tI");var a=n("7ljp"),o=n("LmON"),b=n("EYWl");var c={},i={_frontmatter:c},r=o.a;function s(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,o={},b=Object.keys(e);for(a=0;a<b.length;a++)n=b[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["components"]);return Object(a.b)(r,Object.assign({},i,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)(b.a,{title:"Component Component",description:"A dynamic, functional version of a React.Component; a component component if you will.",mdxType:"SEO"}),Object(a.b)("h1",{id:"component-component"},"Component Component"),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"NOTE: This component was developed in the days before React Hooks.\nIn most cases, you should probably build your function components using hooks and use a class\ncomponent in the rare cases you need them. We may deprecate this component in the future.")),Object(a.b)("p",null,"A dynamic, functional version of ",Object(a.b)("inlineCode",{parentName:"p"},"React.Component"),", a component component if you will. Useful for inline lifecycles and state."),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'<Component initialState={{ hue: 0 }}>\n  {({ setState, state }) => (\n    <div style={{ textAlign: "center" }}>\n      <button onClick={() => setState({ hue: Math.random() * 360 })}>\n        Generate Triad Colorscheme\n      </button>\n      <br />\n      {[1, 2, 3].map((n) => (\n        <div\n          key={n}\n          style={{\n            display: "inline-block",\n            margin: 10,\n            width: "2em",\n            height: "2em",\n            borderRadius: "50%",\n            background: `hsl(${state.hue + n * 120}, 50%, 50%)`,\n            transition: "background-color 200ms ease",\n          }}\n        />\n      ))}\n    </div>\n  )}\n</Component>\n')),Object(a.b)("h2",{id:"installation"},"Installation"),Object(a.b)("p",null,"From the command line in your project directory, run ",Object(a.b)("inlineCode",{parentName:"p"},"npm install @reach/component-component")," or ",Object(a.b)("inlineCode",{parentName:"p"},"yarn add @reach/component-component"),". Then import the component:"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"npm install @reach/component-component\n# or\nyarn add @reach/component-component\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-js"}),'import Component from "@reach/component-component";\n')),Object(a.b)("h2",{id:"component-api"},"Component API"),Object(a.b)("h3",{id:"props"},"Props"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",Object.assign({parentName:"tr"},{align:null}),"Prop"),Object(a.b)("th",Object.assign({parentName:"tr"},{align:null}),"Type"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#initialstate"}),Object(a.b)("inlineCode",{parentName:"a"},"initialState"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"object"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#getinitialstate"}),Object(a.b)("inlineCode",{parentName:"a"},"getInitialState"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#refs"}),Object(a.b)("inlineCode",{parentName:"a"},"refs"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"object"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#getrefs"}),Object(a.b)("inlineCode",{parentName:"a"},"getRefs"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#didmount"}),Object(a.b)("inlineCode",{parentName:"a"},"didMount"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#didupdate"}),Object(a.b)("inlineCode",{parentName:"a"},"didUpdate"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"willunmount"}),Object(a.b)("inlineCode",{parentName:"a"},"willUnmount"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#getsnapshotbeforeupdate"}),Object(a.b)("inlineCode",{parentName:"a"},"getSnapshotBeforeUpdate"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#shouldupdate"}),Object(a.b)("inlineCode",{parentName:"a"},"shouldUpdate"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#children"}),Object(a.b)("inlineCode",{parentName:"a"},"children"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("a",Object.assign({parentName:"td"},{href:"#render"}),Object(a.b)("inlineCode",{parentName:"a"},"render"))),Object(a.b)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"func"))))),Object(a.b)("h4",{id:"initialstate"},"initialState"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"initialState?: object")),Object(a.b)("p",null,"An object of initial state."),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),"// jsx-demo\nfunction Example() {\n  return (\n    <Component initialState={{ count: 10 }}>\n      {({ state }) => <div>Count is {state.count}</div>}\n    </Component>\n  );\n}\n")),Object(a.b)("h4",{id:"getinitialstate"},"getInitialState"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"getInitialState?: () => object")),Object(a.b)("p",null,"A function to return intitial state. Use this when initial state is computed."),Object(a.b)("p",null,"In the following example, ",Object(a.b)("inlineCode",{parentName:"p"},"Date.now()")," will ",Object(a.b)("em",{parentName:"p"},"not")," be called every time a parent component causes this component to re-render."),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),"<Component getInitialState={() => ({ now: Date.now() })}>\n  {({ state }) => <div>Now is: {state.now}</div>}\n</Component>\n")),Object(a.b)("p",null,"However, in the next example, ",Object(a.b)("inlineCode",{parentName:"p"},"Date.now()")," would be called with every re-render, which is not what we want."),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),"// ðŸ˜­\n<Component initialState={{ now: Date.now() }} />\n")),Object(a.b)("h4",{id:"refs"},"refs"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"refs?: object")),Object(a.b)("p",null,"Put any refs you need to keep track of here, stuff like DOM nodes, timers, and subcriptions."),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'// jsx-demo\nfunction Example() {\n  return (\n    <Component refs={{ input: null }}>\n      {({ refs }) => (\n        <form\n          onSubmit={(event) => {\n            event.preventDefault();\n            alert(refs.input.value);\n          }}\n        >\n          <input ref={(node) => (refs.input = node)} type="text" />{" "}\n          <button type="submit">Go</button>\n        </form>\n      )}\n    </Component>\n  );\n}\n')),Object(a.b)("h4",{id:"getrefs"},"getRefs"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"getRefs?: () => object")),Object(a.b)("p",null,"Use this when any of your refs are computed."),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'<Component\n  getRefs={() => {\n    return {\n      input: React.createRef(),\n      popupContainer: document.createElement("div"),\n    };\n  }}\n/>\n')),Object(a.b)("h4",{id:"didmount"},"didMount"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"didMount?: (args: { state: object, props: object, refs: object, setState: Function, forceUpdate: Function }) => void")),Object(a.b)("p",null,"Called when the component mounts."),Object(a.b)("p",null,"Perhaps you want some async data but don't want to make an entirely new component just for the lifecycles to get it:"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'<Component\n  initialState={{ gists: null }}\n  didMount={({ setState }) => {\n    fetch("https://api.github.com/gists?per_page=5")\n      .then((res) => res.json())\n      .then((gists) => setState({ gists }));\n  }}\n>\n  {({ state }) =>\n    state.gists ? (\n      <ul>\n        {state.gists.map((gist) => (\n          <li key={gist.id}>\n            <a href={gist.html_url}>{gist.description || gist.id}</a>\n          </li>\n        ))}\n      </ul>\n    ) : (\n      <div>Loading...</div>\n    )\n  }\n</Component>\n')),Object(a.b)("p",null,"See also ",Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://reactjs.org/docs/react-component.html#componentdidmount"}),"React Docs"),"."),Object(a.b)("h4",{id:"didupdate"},"didUpdate"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"didMount?: (args: { state: object, props: object, refs: object, setState: Function, forceUpdate: Function, prevProps?: object, prevState?: object }) => void")),Object(a.b)("p",null,"Called when the component updates. See ",Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://reactjs.org/docs/react-component.html#componentdidupdate"}),"React Docs"),"."),Object(a.b)("h4",{id:"willunmount"},"willUnmount"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"willUnmount?: (args: { state: object, props: object, refs: object }) => void")),Object(a.b)("p",null,"Called when the component will be removed from the page. See ",Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://reactjs.org/docs/react-component.html#componentwillunmount"}),"React Docs"),"."),Object(a.b)("h4",{id:"getsnapshotbeforeupdate"},"getSnapshotBeforeUpdate"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"getSnapshotBeforeUpdate?: (args: { state: object, props: object, refs: object, prevProps: object, prevState: object }) => any")),Object(a.b)("p",null,"See ",Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://reactjs.org/docs/react-component.html#getsnapshotbeforeupdate"}),"React Docs"),"."),Object(a.b)("h3",{id:"shouldupdate"},"shouldUpdate"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"shouldUpdate?: (args: { state: object, props: object, nextProps: object, nextState: object }) => boolean")),Object(a.b)("p",null,"Return ",Object(a.b)("inlineCode",{parentName:"p"},"true")," to signify the component needs an update, ",Object(a.b)("inlineCode",{parentName:"p"},"false")," if it does not. Useful for wrapping up expensive parts of your app without having to refactor to new components."),Object(a.b)("p",null,"For example: often you find just one part of your component is expensive to render, maybe because of a large SVG with a dynamic style or two. Rather than pulling the elements out of your component and putting them in a new ",Object(a.b)("inlineCode",{parentName:"p"},"PureComponent"),", you can inline a ",Object(a.b)("inlineCode",{parentName:"p"},"shoudlUpdate")," check:"),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'// jsx-demo\nfunction Example() {\n  return (\n    <Component initialState={{ hue: 0 }}>\n      {({ setState, state }) => (\n        <div>\n          <button\n            onClick={() => {\n              setState({ hue: Math.random() * 360 });\n            }}\n          >\n            Change Color\n          </button>\n\n          <Component\n            hue={state.hue}\n            shouldUpdate={({ nextProps, props }) => {\n              return nextProps.hue !== props.hue;\n            }}\n          >\n            <div>\n              <svg width="100" height="100">\n                <path\n                  d="M20,30 Q40,5 50,30 T90,30"\n                  fill="none"\n                  stroke={`hsl(${state.hue}, 50%, 50%)`}\n                  strokeWidth="5"\n                />\n              </svg>\n            </div>\n          </Component>\n        </div>\n      )}\n    </Component>\n  );\n}\n')),Object(a.b)("p",null,"See also ",Object(a.b)("a",Object.assign({parentName:"p"},{href:"https://reactjs.org/docs/react-component.html#shouldcomponentupdate"}),"React Docs"),"."),Object(a.b)("h4",{id:"children"},"children"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"children?: React.ReactNode | ((args: { state: object, props: object, refs: object, setState: Function, forceUpdate: Function }) => React.ReactNode)")),Object(a.b)("p",null,"Usual React children prop or render prop callback to provide the stateful parts of your component at render time.."),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),"// jsx-demo\nfunction Example() {\n  return (\n    <Component>\n      <div>Hey, I am the child</div>\n    </Component>\n  );\n}\n")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'// jsx-demo\nfunction Example() {\n  return (\n    <Component initialState={{ hue: 0 }}>\n      {({ setState, state }) => (\n        <div>\n          <button onClick={() => setState({ hue: Math.random() * 360 })}>\n            Generate Color\n          </button>\n          <br />\n          <svg width="100" height="100">\n            <path\n              d="M20,30 Q40,5 50,30 T90,30"\n              fill="none"\n              stroke={`hsl(${state.hue}, 50%, 50%)`}\n              strokeWidth="5"\n            />\n          </svg>\n        </div>\n      )}\n    </Component>\n  );\n}\n')),Object(a.b)("h4",{id:"render"},"render"),Object(a.b)("p",null,Object(a.b)("inlineCode",{parentName:"p"},"render?: (args: { state: object, props: object, refs: object, setState: Function, forceUpdate: Function }) => React.ReactNode")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'// jsx-demo\nfunction Example() {\n  return (\n    <Component\n      initialState={{ hue: 0 }}\n      render={({ setState, state }) => (\n        <div>\n          <button onClick={() => setState({ hue: Math.random() * 360 })}>\n            Generate Color\n          </button>\n          <br />\n          <svg width="100" height="100">\n            <path\n              d="M20,30 Q40,5 50,30 T90,30"\n              fill="none"\n              stroke={`hsl(${state.hue}, 50%, 50%)`}\n              strokeWidth="5"\n            />\n          </svg>\n        </div>\n      )}\n    />\n  );\n}\n')),Object(a.b)("h2",{id:"todo-app-example"},"Todo App Example"),Object(a.b)("p",null,"Here is a pretty involved example showing just how composable this component is:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},'"App state" containing all todos'),Object(a.b)("li",{parentName:"ul"},'"Todo state" containing state for a specific todo'),Object(a.b)("li",{parentName:"ul"},"Updates the document title to the number of todos in the list"),Object(a.b)("li",{parentName:"ul"},"Optimized todo rendering, avoiding updates if the color has not changed"),Object(a.b)("li",{parentName:"ul"},"Tracked refs")),Object(a.b)("pre",null,Object(a.b)("code",Object.assign({parentName:"pre"},{className:"language-jsx"}),'// jsx-demo\nfunction Example() {\n  return (\n    <Component\n      getRefs={() => ({\n        input: React.createRef(),\n      })}\n      getInitialState={() => {\n        return {\n          todos: ["This is kinda weird"],\n        };\n      }}\n    >\n      {({ state, setState, refs }) => (\n        <>\n          <Component\n            didUpdate={() => (document.title = state.todos.length + " Todos")}\n          />\n          <div style={{ fontFamily: "sans-serif" }}>\n            <h4>Todo List</h4>\n            <form\n              onSubmit={(event) => {\n                event.preventDefault();\n                let node = refs.input.current;\n                setState({ todos: state.todos.concat([node.value]) });\n                node.value = "";\n              }}\n            >\n              <input ref={refs.input} />\n            </form>\n            <div>\n              {state.todos.map((todo, index) => (\n                <Component\n                  key={index}\n                  getInitialState={() => ({ hue: Math.random() * 360 })}\n                  todo={todo}\n                  shouldUpdate={({ nextProps, nextState, props, state }) => {\n                    return (\n                      nextProps.todo !== props.todo ||\n                      nextState.hue !== state.hue\n                    );\n                  }}\n                >\n                  {({ setState, state }) => (\n                    <div style={{ color: `hsl(${state.hue}, 50%, 50%)` }}>\n                      <button\n                        onClick={() => {\n                          setState({ hue: Math.random() * 360 });\n                        }}\n                      >\n                        Change Color\n                      </button>{" "}\n                      {todo}\n                    </div>\n                  )}\n                </Component>\n              ))}\n            </div>\n            <p>\n              <button onClick={() => setState({ todos: [] })}>Clear all</button>\n            </p>\n          </div>\n        </>\n      )}\n    </Component>\n  );\n}\n')))}s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-component-component-mdx-e7bb35978578ff0a1f0f.js.map